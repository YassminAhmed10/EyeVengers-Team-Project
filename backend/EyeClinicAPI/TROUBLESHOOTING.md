# ?? ????? "Failed to fetch"

## ??????? ???????? ??? ???????:

### 1. ????? ????? ???????? ???? Migration ??????

???? Terminal ?? ???? `EyeClinicAPI` ????:

```bash
dotnet ef database update
```

??? ?? ???? ?????? ???:
```bash
cd EyeClinicAPI
dotnet ef database update
```

### 2. ????? ????? HTTPS Certificate

?? ??? Terminal ???:
```bash
dotnet dev-certs https --trust
```

???? "Yes" ????? ???? ???????.

### 3. ?????? ?? ???? ?????? Doctors ?? ????? ????????

??? ????? Appointments? ????? ?????? Doctor ???? ??? ?????:

#### ??????? ?????? - ???????? Swagger:
1. ??? ??? API: `dotnet run` ?? ???? `EyeClinicAPI`
2. ???? ??????? ???: `https://localhost:7071/swagger`
3. ???? `POST /api/Doctors`
4. ??? doctor ????:
```json
{
  "fullName": "Dr. Ahmed Ali",
  "specialization": "Ophthalmologist",
  "phoneNumber": "0123456789",
  "email": "ahmed@clinic.com"
}
```

#### ??????? ??????? - ???????? SQL:
???? SQL Server Management Studio ?? Visual Studio SQL Server Object Explorer ????:
```sql
USE EyeClinicDB;

INSERT INTO Doctors (FullName, Specialization, PhoneNumber, Email, CreatedAt)
VALUES ('Dr. Ahmed Ali', 'Ophthalmologist', '0123456789', 'ahmed@clinic.com', GETDATE());
```

### 4. ????? ??? API

```bash
cd EyeClinicAPI
dotnet run --launch-profile https
```

??? ?? ????:
```
Now listening on: https://localhost:7071
Now listening on: http://localhost:5201
```

### 5. ????? ??? Frontend

?? Terminal ????:
```bash
cd frontend
npm run dev
```

### 6. ?????? ?? ???????

???? ??????? ??? `http://localhost:5173` ???? ?? ???? ???? ?????.

## ??????? ??????? ???????:

### ?????: "SSL certificate problem"
**????:**
```bash
dotnet dev-certs https --clean
dotnet dev-certs https --trust
```

### ?????: "Failed to fetch" ?? ???? ??????
**????:**
1. ???? ?? ??? API ???? ??? `https://localhost:7071`
2. ???? ?? ??? `.env` ?? Frontend ????? ???:
   ```
   VITE_API_BASE=https://localhost:7071
   ```
3. ???? ?? ??? ???? Firewall ???? ???????

### ?????: "CORS error"
**????:** ?? ??????? ?? `Program.cs` - ??? ??? ????? ??? API

### ?????: "Doctor with ID 1 does not exist"
**????:** ???? ?????? 3 ????? ?????? Doctor

### ?????: Database connection error
**????:**
1. ???? ?? SQL Server LocalDB ????
2. ??? ????? Connection String ?? `appsettings.json`:
```json
"DefaultConnection": "Server=(localdb)\\mssqllocaldb;Database=EyeClinicDB;Trusted_Connection=True;MultipleActiveResultSets=true;TrustServerCertificate=True"
```

## ?????? ?? ?? ?? ??? ????:

1. ? ??? API ???? ????? Swagger ??? `https://localhost:7071/swagger`
2. ? ???? ????? Doctor ?? Swagger
3. ? ???? ????? Appointment ?? Swagger
4. ? Dashboard ???? ????????
5. ? ???? ????? Appointment ?? ??? Frontend

## ?????? ?????????:

### ?? `Program.cs`:
- ? ????? CORS settings
- ? ????? ?????? ?? origins ????????
- ? ????? Developer Exception Page
- ? ????? AllowCredentials

### ?? `AppointmentsController.cs`:
- ? ????? Logger ???????
- ? ????? ?????? ??????? ?? POST
- ? ?????? ?? ???? Doctor ??? ????? Appointment
- ? Validation ???? ???????? ???????
- ? ????? ??? ?????

### ?? `Appointment.cs`:
- ? ????? Phone ? Email (?????? ?????? ?? Migration)

## ?????? ????:

???? Developer Console ?? ??????? (F12) ????:

```javascript
fetch('https://localhost:7071/api/Doctors')
  .then(r => r.json())
  .then(console.log)
  .catch(console.error);
```

??? ???? ????????? ??????? ??????! ?
